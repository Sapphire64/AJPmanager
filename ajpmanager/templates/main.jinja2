{% extends "templates/base.jinja2" %}

{% block styles %}
{% endblock %}
{% block body_styles %}
{% endblock %}

<link rel="stylesheet" href="{{ request.static_url('ajpmanager:static/noVNC/base.css') }}">
{% block content %}

    <!--
                       _   _             _
                      | \ | | __ ___   _| |__   __ _ _ __
                      |  \| |/ _` \ \ / / '_ \ / _` | '__|
                      | |\  | (_| |\ V /| |_) | (_| | |
                      |_| \_|\__,_| \_/ |_.__/ \__,_|_|

    -->


    <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container-fluid">
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>
                <a class="brand" href="#" onclick="show_default_screen();"><span style="color: red;">力</span> AJPmanager</a>
                <div class="nav-collapse" id="bar">
                    <ul class="nav">
                        <li><a href="#about">About</a></li>
                        <li><a href="#contact">Contact</a></li>
                    </ul>
                    <p id="username" class="navbar-text pull-right">Logged in as <a href="#" onclick="show_usersinfo_modal(true);">{{ username }}</a></p>
                </div><!--/.nav-collapse -->

            </div>
        </div>
    </div>

    <div class="navbar navbar-fixed-bottom">
        <div class="navbar-inner">
            <div class="container-fluid">
                <div align="center">
                    <!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
                    <!-- Consider adding a manifest.appcache: h5bp.com/d/Offline -->
                    <!--[if gt IE 8]><!-->
                    <div class="btn-toolbar">
                        <p id="hide_menus" class="navbar-text pull-left"><a class="btn" onclick="hide_menus()"><i class="icon-resize-small"></i> Hide/Show Menus</a></p>
                        <input id="stats" type="text" class="span8 disabled"  style="margin-top: 7px;" disabled>
                        <btn class="btn btn-info" onclick="query_all();"><i class="icon-refresh"></i></btn>
                        <p id="logout" class="navbar-text pull-right"><a class="btn" href="/logout"><i class="icon-signout"></i> Logout</a></p>
                    </div>

                </div>
            </div><!--/.nav-collapse -->
        </div>
    </div>
    </div>

    <!--
                _          __ _
               | |    ___ / _| |_    _ __ ___   ___ _ __  _   _
               | |   / _ \ |_| __|  | '_ ` _ \ / _ \ '_ \| | | |
               | |__|  __/  _| |_   | | | | | |  __/ | | | |_| |
               |_____\___|_|  \__|  |_| |_| |_|\___|_| |_|\__,_|

    -->


    <div class="container-fluid">
    <div class="row-fluid">
    <div id="left_menu" class="span2">
        <div class="well sidebar-nav">
            <ul class="nav nav-tabs nav-stacked">
                <li class="nav-header">Models control</li>
                <li id="main_entry" class="active"><a href="#" onclick="show_default_screen();"><i class="icon-white icon-home"></i> Main screen</a></li>
                <li id="view_entry" class="hide"><a href="#"><i class="icon-user"></i> View machine</a></li>
                <li id="vnc_entry" class="hide"><a href="#" onclick="activate_vnc_screen();"><i class="icon-eye-open"></i> Machine console</a></li>
                <li id="edit_entry" class="hide"><a href="#"><i class="icon-pencil"></i>  Edit machine</a></li>
                {% if 'group:admins' in user_groups %}
                <li class="nav-header">Configuration</li>
                {% else %}
                <li class="nav-header">Information</li>
                {% endif %}
                <li id="users_entry"><a href="#" onclick="show_users_list();"><i class="icon-user"></i> Users</a></li>
                {% if 'group:admins' in user_groups %}
                <li id="settings_entry"><a href="#" onclick="show_settings();"><i class="icon-cog"></i> Settings</a></li>
                {% endif %}
                <li id="help_entry"><a href="#" onclick="show_help();"><i class="icon-flag"></i> Help</a></li>

                <li class="nav-header">Links</li>
                <li><a href="http://docs.pylonsproject.org/en/latest/docs/pyramid.html"><i class="icon-book"></i> Pyramid Documentation</a></li>
                <li><a href="http://github.com/Sapphire64/AJPmanager"><i class="icon-github-sign"></i> Project on GitHub</a></li>
                <li><a href="http://cs.donntu.edu.ua/English/indexEn.php"><i class="icon-home"></i> Computer Science Faculty</a></li>


            </ul>
        </div><!--/.well -->

        <!--
                             _        _   _
                            / \   ___| |_(_)_   _____
                           / _ \ / __| __| \ \ / / _ \
                          / ___ \ (__| |_| |\ V /  __/
                         /_/   \_\___|\__|_| \_/ \___|

                                           _   _
                 ___  _ __   ___ _ __ __ _| |_(_) ___  _ __  ___
                / _ \| '_ \ / _ \ '__/ _` | __| |/ _ \| '_ \/ __|
               | (_) | |_) |  __/ | | (_| | |_| | (_) | | | \__ \
                \___/| .__/ \___|_|  \__,_|\__|_|\___/|_| |_|___/
                     |_|
        -->

        <div class="well">
            <div class="left_framer">
                <table class="table table-condensed table-centered" style="background-color: #ffffff;">
                    <thead>
                    <tr>
                        <th style="width: 160px;">Active operations</th>
                        <th style="width: 80px;">Action</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>Image installation</td>
                        <td><div class="label label-info pointer" onclick="show_operations_modal(1);">Info</div></td>
                    </tr>





                    </tbody>
                </table>

            </div>
        </div><!--/.well -->


    </div><!--/span-->

    <div id="center_menu" class="span7">

    <!--
           __  __            _     _                     _ _     _
          |  \/  | __ _  ___| |__ (_)_ __   ___  ___    | (_)___| |_
          | |\/| |/ _` |/ __| '_ \| | '_ \ / _ \/ __|   | | / __| __|
          | |  | | (_| | (__| | | | | | | |  __/\__ \   | | \__ \ |_
          |_|  |_|\__,_|\___|_| |_|_|_| |_|\___||___/   |_|_|___/\__|

    -->

        <div class="well hide" id="machines_list">
            <h3 align="center">Virtual Machines List</h3>
            <br>

            <table id="machines_table" class="table table-striped table-centered" style="background-color: #ffffff;">
                <thead>
                <tr>
                    <th style="width: 30px;">#</th>
                    <th style="width: 200px;">Name</th>
                    <th style="width: 150px;">Type</th>
                    <th style="width: 150px;">Load</th>
                    <th style="width: 30px;">Cores</th>
                    <th style="width: 110px;">Memory</th>
                    <th style="width: 30px;">Status</th>
                    <th style="width: 25px;">
                        <input id="check0" type="checkbox" onchange="note_checkboxes(this);">
                    </th>
                </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div> <!-- Running machines DIV -->


    <!--
                        _   ___  _______
               ___  ___| | / / |/ / ___/  ___ ___________ ___ ___
              / _ \/ _ \ |/ /    / /__   (_-</ __/ __/ -_) -_) _ \
             /_//_/\___/___/_/|_/\___/  /___/\__/_/  \__/\__/_//_/

    -->


        <div id="noVNC_screen" class="hide well" align="center">
            <div id="noVNC_status_bar" class="noVNC_status_bar" style="margin-top: 0px;">
                <table border=0 width="100%"><tr>
                    <td><div id="noVNC_status">Loading</div></td>
                    <td width="1%"><div id="noVNC_buttons">
                        <input type=button value="Send CtrlAltDel"
                               id="sendCtrlAltDelButton">
                    </div></td>
                </tr></table>
            </div>
            <canvas id="noVNC_canvas" width="640px" height="20px">
                Canvas not supported.
            </canvas>
        </div>


<!--
   ____       _        _ _          _    __  __            _     _
  |  _ \  ___| |_ __ _(_) | ___  __| |  |  \/  | __ _  ___| |__ (_)_ __   ___
  | | | |/ _ \ __/ _` | | |/ _ \/ _` |  | |\/| |/ _` |/ __| '_ \| | '_ \ / _ \
  | |_| |  __/ || (_| | | |  __/ (_| |  | |  | | (_| | (__| | | | | | | |  __/
  |____/ \___|\__\__,_|_|_|\___|\__,_|  |_|  |_|\__,_|\___|_| |_|_|_| |_|\___|

                               _        __
                              (_)_ __  / _| ___
                              | | '_ \| |_ / _ \
                              | | | | |  _| (_) |
                              |_|_| |_|_|  \___/

-->


        <div class="well hide" id="machine_detailed_info">

            <div class="btn-group">
                <btn class="btn btn-warning btn-large" title="Edit selected virtual machine"><i class="icon-pencil"></i></btn>
                <btn class="btn btn-primary btn-large" title="Clone selected virtual machine"><i class="icon-share"></i></btn>
                <btn class="btn btn-danger btn-large" title="Delete selected virtual machine"><i class="icon-remove"></i></btn>
            </div>
            detailed info screen




        </div>

<!--

          _____    _ _ _                           _     _
         | ____|__| (_) |_    _ __ ___   __ _  ___| |__ (_)_ __   ___
         |  _| / _` | | __|  | '_ ` _ \ / _` |/ __| '_ \| | '_ \ / _ \
         | |__| (_| | | |_   | | | | | | (_| | (__| | | | | | | |  __/
         |_____\__,_|_|\__|  |_| |_| |_|\__,_|\___|_| |_|_|_| |_|\___|


                          ___  ___ _ __ ___  ___ _ __
                         / __|/ __| '__/ _ \/ _ \ '_ \
                         \__ \ (__| | |  __/  __/ | | |
                         |___/\___|_|  \___|\___|_| |_|

-->


        <div class="well hide" id="edit_machine_screen">

            edit machine screen




        </div>


        <!--
                     _   _                      _ _     _
                    | | | |___  ___ _ __ ___   | (_)___| |_
                    | | | / __|/ _ \ '__/ __|  | | / __| __|
                    | |_| \__ \  __/ |  \__ \  | | \__ \ |_
                     \___/|___/\___|_|  |___/  |_|_|___/\__|
        -->


        <div class="well hide" id="users_screen">
            <h3 align="center">Users</h3>
            <br>

            <table id="users_table" class="table table-striped table-centered" style="background-color: #ffffff;">
                <thead>
                <tr>
                    <th style="width: 30px;">UID</th>
                    <th style="width: 150px;">Username</th>
                    <th style="width: 150px;">First name</th>
                    <th style="width: 150px;">Last name</th>
                    <th style="width: 30px;">Group</th>
                    <th style="width: 30px;">Status</th>
                    <th style="width: 25px;">
                        <input id="ucheck0" type="checkbox" onchange="users_note_checkboxes(this);">
                    </th>
                </tr>
                </thead>
                <tbody>
                </tbody>
            </table>

        </div>


    {% if 'group:admins' in user_groups %}
<!--
      ____       _   _   _
     / ___|  ___| |_| |_(_)_ __   __ _ ___    ___  ___ _ __ ___  ___ _ __
     \___ \ / _ \ __| __| | '_ \ / _` / __|  / __|/ __| '__/ _ \/ _ \ '_ \
      ___) |  __/ |_| |_| | | | | (_| \__ \  \__ \ (__| | |  __/  __/ | | |
     |____/ \___|\__|\__|_|_| |_|\__, |___/  |___/\___|_|  \___|\___|_| |_|
                                 |___/
-->

        <div class="well hide" id="settings_screen">

            <ul id="tab" class="nav nav-tabs">
                <li class="active"><a href="#hypervisor" data-toggle="tab">Hypervisor settings</a></li>
            </ul>
            <div id="TabContent" class="tab-content">

                <div class="tab-pane fade in active" id="hypervisor">
                    <h3 align="center">Settings</h3>
                    <br>

                    <div class="row-fluid">
                        <div class="span2">

                        </div>

                        <div class="span8">
                            <form class="form-horizontal">
                                <fieldset>
                                    <div class="control-group">
                                        <label class="control-label" for="vmprovider_settings">VM Provider</label>
                                        <div class="controls">
                                            <input class="input-xlarge disabled" style="text-align: center;" id="vmprovider_settings" type="text" placeholder="kvm" disabled>
                                        </div>
                                    </div>

                                    <div class="control-group">
                                        <label class="control-label">Hypervisor URI</label>
                                        <div class="controls">
                                            <input type="text"  style="text-align: center;" class="input-xlarge" id="vmmanager_settings">
                                        </div>
                                    </div>

                                    <div class="control-group">
                                        <label class="control-label">Root VM folder</label>
                                        <div class="controls">
                                            <input type="text"  style="text-align: center;" class="input-xlarge" id="path_settings">
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Presets folder</label>
                                        <div class="controls">
                                            <input type="text"  style="text-align: center;" class="input-xlarge" id="presets_settings">
                                            <p class="help-block">Name of the folder to store presets of the virtual machines</p>
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Images folder</label>
                                        <div class="controls">
                                            <input type="text"  style="text-align: center;" class="input-xlarge" id="images_settings">
                                            <p class="help-block">Name of the folder to store working virtual machines</p>
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Disk image file name</label>
                                        <div class="controls">
                                            <input type="text"  style="text-align: center;" class="input-xlarge" id="image_settings">
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Config file name</label>
                                        <div class="controls">
                                            <input type="text"  style="text-align: center;" class="input-xlarge" id="config_settings">
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label">Description file name</label>
                                        <div class="controls">
                                            <input type="text"  style="text-align: center;" class="input-xlarge" id="description_settings">
                                        </div>
                                    </div>
                                    <div class="form-actions">
                                        <button type="button" onclick="apply_settings();" class="btn btn-success">Save changes</button>
                                        <button type="button" onclick="restore_settings();" class="btn btn-info">Restore saved</button>
                                        <button type="button" onclick="restore_default_settings_ask();" class="btn btn-primary">Restore defaults</button>
                                        <button type="button" onclick="show_default_screen();" class="btn">Cancel</button>
                                    </div>
                                </fieldset>
                            </form>
                        </div>
                        <div class="span2">

                        </div>
                    </div>
                </div>

                </div>
            </div>
    {% endif %}


    <!--

              _   _      _       _
             | | | | ___| |_ __ | |   ___  ___ _ __ ___  ___ _ __
             | |_| |/ _ \ | '_ \| |  / __|/ __| '__/ _ \/ _ \ '_ \
             |  _  |  __/ | |_) |_|  \__ \ (__| | |  __/  __/ | | |
             |_| |_|\___|_| .__/(_)  |___/\___|_|  \___|\___|_| |_|
                          |_|

    -->


        <div class="well hide" id="help_screen">

            help screen




        </div>

    </div>


<!--
              ____  _       _     _                             _
             |  _ \(_) __ _| |__ | |_    _ __   __ _ _ __   ___| |
             | |_) | |/ _` | '_ \| __|  | '_ \ / _` | '_ \ / _ \ |
             |  _ <| | (_| | | | | |_   | |_) | (_| | | | |  __/ |
             |_| \_\_|\__, |_| |_|\__|  | .__/ \__,_|_| |_|\___|_|
                      |___/             |_|
-->


    <div id="right_menu" class="span3">
        <div id="quick_manage_block" class="well">
            <h3 align="center">
                Manager
            </h3>
            <br>



            <table class="table table-bordered table-centered" style="background-color: #ffffff;">
                <thead>
                <tr>
                    <th style="width: 30px;">#</th>
                    <th style="width: 200px;">Name</th>
                    <th style="width: 150px;">Type</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td id="selected_id">3</td>
                    <td id="selected_name"></td>
                    <td id="selected_type">…</td>
                </tr>
                </tbody>
            </table>

            <div align="center">
                <div class="btn-toolbar">

                    <div class="btn-group">
                        <btn id="run_button" class="btn btn-success btn-large disabled" title="Run all" onclick="operate_machine('run')"><i class="icon-play"></i></btn>
                        <btn id="pause_button" class="btn btn-warning btn-large disabled" title="Pause all" onclick="operate_machine('pause')"><i class="icon-pause"></i></btn>
                        <btn id="stop_button" class="btn btn-danger btn-large disabled" title="Stop all" onclick="operate_machine('stop')"><i class="icon-stop"></i></btn>
                        <btn id="destroy_button" class="btn btn-danger btn-large hide" title="Stop all" onclick="operate_machine('destroy')"><i class="icon-remove"></i></btn>
                    </div>

                    <div class="btn-group">
                        <btn id="vnc_button" class="btn btn-large disabled" title="View selected virtual machine" onclick="activate_vnc_screen();"><i class="icon-eye-open"></i></btn>
                        <btn id="unvnc_button" class="btn btn-danger btn-large" title="Unview selected virtual machine" onclick="unshow_vnc_screen();"><i class="icon-eye-close"></i></btn>
                    </div>

                    <div class="btn-group">
                        <btn id="detailed_info_button" class="btn btn-info btn-large disabled" title="Detailed information about selected VM" onclick="show_detailed_info(false);"><i class="icon-info-sign"></i></btn>
                    </div>

                </div>
            </div>

        </div>


        <!--
                                        _   _                           _ _ _
                                       | | | |___  ___ _ __     ___  __| (_) |_
                                       | | | / __|/ _ \ '__|   / _ \/ _` | | __|
                                       | |_| \__ \  __/ |     |  __/ (_| | | |_
                                        \___/|___/\___|_|      \___|\__,_|_|\__|

        -->





        <div id="users_settings" class="well hide">
            <h3 align="center">
                User edit
            </h3>
            <br>



            <table class="table table-bordered table-centered" style="background-color: #ffffff;">
                <thead>
                <tr>
                    <th style="width: 30px;">#</th>
                    <th style="width: 200px;">Name</th>
                    <th style="width: 150px;">Type</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td id="selected_user_id">3</td>
                    <td id="selected_user_name"></td>
                    <td id="selected_user_type">…</td>
                </tr>
                </tbody>
            </table>

            <div align="center">
                <div class="btn-toolbar">
                    {% if 'group:admins' in user_groups or 'group:moderators' in user_groups %}
                    <div class="btn-group">
                        <btn id="new_user" class="btn btn-success btn-large" title="Add new user into system" onclick="show_addusers_modal()">
                            <i class="icon-plus"></i> Add new
                        </btn>
                    </div>
                    {% endif %}

                    <div class="btn-group">
                        <btn id="user_info" class="btn btn-info btn-large" title="Detailed info about selected user" onclick="show_usersinfo_modal()">
                            <i class="icon-info-sign"></i> Your info
                        </btn>
                    </div>

                    {% if 'group:admins' in user_groups or 'group:moderators' in user_groups %}
                    <div class="btn-group">
                        <btn id="delete_user" class="btn btn-warning btn-large disabled" title="Delete selected user from the system" onclick="delete_user()">
                            <i class="icon-remove-sign"></i> Delete
                        </btn>
                    </div>
                    {% endif %}
                </div>
            </div>

        </div>



        <!--
                        ____            _           _
                       |  _ \ _ __ ___ (_) ___  ___| |_
                       | |_) | '__/ _ \| |/ _ \/ __| __|
                       |  __/| | | (_) | |  __/ (__| |_
                       |_|   |_|  \___// |\___|\___|\__|
                                     |__/
                     _ _          _       _
                  __| (_)___  ___| | __ _(_)_ __ ___   ___ _ __
                 / _` | / __|/ __| |/ _` | | '_ ` _ \ / _ \ '__|
                | (_| | \__ \ (__| | (_| | | | | | | |  __/ |
                 \__,_|_|___/\___|_|\__,_|_|_| |_| |_|\___|_|

        -->

        <div id="project_info" class="well hide">
            <h3 align="center">
                AJPmanager info
            </h3>
            <p style="color: #ff0000;" align="center"><b>This project is currently under development, we are looking for contributors!</b></p>
            <p>You can help if you are familiar with any of this technologies:
            <ul><li>Python, Pyramid Framework, libvirt</li><li>HTML5, CSS, JavaScript</li> <li>XenAPI, Libvirt or any other VM technology</li></ul></p>

            <div align="center"><btn class="btn btn-large btn-primary">Visit us on <b>Github</b> <i class="icon-github-sign"></i></btn></div>

        </div>

        {% if 'group:admins' in user_groups or 'group:moderators' in user_groups %}
        <!--
                ____                     _          _ _     _
               |  _ \ _ __ ___  ___  ___| |_ ___   | (_)___| |_
               | |_) | '__/ _ \/ __|/ _ \ __/ __|  | | / __| __|
               |  __/| | |  __/\__ \  __/ |_\__ \  | | \__ \ |_
               |_|   |_|  \___||___/\___|\__|___/  |_|_|___/\__|
        -->

        <div class="well" id="presets_list">
            <h4 align="center">Add new machine from preset</h4>


            <div class="framer">
                <br>
                <table id="presets_table" class="table table-condensed table-centered" style="background-color: #ffffff;">

                    <thead>
                    <tr>
                        <th style="width: 30px;">#</th>
                        <th style="width: 200px;">Preset</th>
                        <th style="width: 100px;">Action</th>
                    </tr>
                    </thead>
                    <tbody>


                    </tbody>
                </table>

            </div>

            <br><br>
        </div>


    </div>
    {% endif %}
    </div><!--/row-->



    <!--
                     __  __           _       _
                    |  \/  | ___   __| | __ _| |___
                    | |\/| |/ _ \ / _` |/ _` | / __|
                    | |  | | (_) | (_| | (_| | \__ \
                    |_|  |_|\___/ \__,_|\__,_|_|___/

    -->


    <div class="modal hide fade" id="opModal">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">×</a>
            <h3>Active operations</h3>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
            <a href="#" class="btn btn-large" data-dismiss="modal" >Close</a>
        </div>
    </div>



    {# This solution is not the greatest
      (we are making two queries but we can read all the info except email from the first),
      but in case of program's extension
      (with more user info which shouldn't be loaded in general)
      this can be a plus #}
    <div class="modal hide fade users_modal" id="infoModal">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">×</a>
            <h3>User info</h3>
        </div>
        <div class="modal-body">

            {% if 'group:admins' in user_groups or 'group:moderators' in user_groups %}

            <div class="row-fluid">

                <div class="span8">

                {% endif %}

                    <div id="user_edit_danger_block" class="alert alert-error hide">

                    </div>

                    <div id="user_edit_success_block" class="alert alert-success hide">

                    </div>

                    <form class="form-horizontal">
                        <fieldset>
                            <div class="control-group">
                                <label class="control-label" for="view_username">Username</label>
                                <div class="controls">
                                    <input type="text" class="input-xlarge centered darkize" id="view_username" placeholder="username" disabled>
                                    <a id="online_img" class="btn" href="#"><i class="icon-user" style="color: #ffffff;" disabled></i></a>
                                </div>
                            </div>
                            <div class="control-group">
                                <label class="control-label" for="view_email">Email</label>
                                <div class="controls">
                                    <input type="text" class="input-xlarge darkize centered" id="view_email" placeholder="email" disabled>
                                    <a id="mailto" title="Send email to the user" class="btn" href="mailto:foo@mail.com"><i class="icon-envelope"></i></a>
                                </div>
                            </div>
                            <div class="control-group">
                                <label class="control-label" for="view_first_name">First name</label>
                                <div class="controls">
                                    <input type="text" class="input-xlarge centered darkize" id="view_first_name" placeholder="first name" disabled>
                                </div>
                            </div>
                            <div class="control-group">
                                <label class="control-label" for="view_last_name">Last name</label>
                                <div class="controls">
                                    <input type="text" class="input-xlarge centered darkize" id="view_last_name" placeholder="last name" disabled>
                                </div>
                            </div>

                            <div id="change_password_container" class="hide">
                                <div class="control-group">
                                    <label class="control-label" for="view_group">Group</label>
                                    <div class="controls">
                                        <input type="text" class="input-xlarge centered darkize" id="view_group" placeholder="group name" disabled>
                                    </div>
                                </div>

                                <h4>Change password</h4>
                                <br>
                                <div class="control-group" id="old_password_group">
                                    <label class="control-label" for="old_password">Old password</label>
                                    <div class="controls">
                                        <input type="password" class="input-xlarge centered darkize" id="old_password" placeholder="password">
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label" for="change_password">New password</label>
                                    <div class="controls">
                                        <input type="password" class="input-xlarge centered darkize" id="change_password" placeholder="password">
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label" for="change_password_confirm">Confirm password</label>
                                    <div class="controls">
                                        <input type="password" class="input-xlarge centered darkize" id="change_password_confirm" placeholder="password">
                                    </div>
                                </div>
                            </div>

                        </fieldset>
                    </form>

                {% if 'group:admins' in user_groups or 'group:moderators' in user_groups %}

                    </div>

                    <div class="span4">

                        <div class="control-group">
                            <label class="control-label" for="groups_select">Allowed machines for user</label>
                            <div class="controls">
                                <select multiple="multiple" style="height: 320px" id="machines_select">
                                </select>
                            </div>
                            <span>Press CTRL to deselect machine</span>
                        </div>

                    </div>

                </div>

                {% endif %}

            </div>
        <div class="modal-footer">
            <a href="#" id="update_user_info_btn"
               class="btn btn-large btn-success hide"
               style="color: #ffffff;"
               onclick="update_user_info();">Update info</a>
            <a href="#" class="btn btn-large" data-dismiss="modal" onclick="show_users_list();">Close</a>
        </div>
    </div>


    {% if 'group:admins' in user_groups or 'group:moderators' in user_groups %}
    <div id="usersModal" class="users_modal hide fade">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">&times;</a>
            <h3>Add new user</h3>
        </div>
        <div class="modal-body">


            <div id="user_danger_block" class="alert alert-error hide">

            </div>

            <div id="user_success_block" class="alert alert-success hide">

            </div>

            <div class="row-fluid">
                    <div class="span8">
                        <div align="center">
                            <div class="alert hide">
                                <button type="button" class="close" data-dismiss="alert">×</button>

                            </div>
                        </div>
                        <form class="form-horizontal">
                            <fieldset>
                                <div class="control-group">
                                    <label class="control-label" for="new_username"><b>Username *</b></label>
                                    <div class="controls">
                                        <input type="text" class="input-xlarge centered" id="new_username" placeholder="username">
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label" for="new_email"><b>Email*</b></label>
                                    <div class="controls">
                                        <input type="text" class="input-xlarge centered" id="new_email" placeholder="email">
                                    </div>
                                    <br>
                                    <div class="controls">
                                        <input type="checkbox" id="send_email" value="option1">
                                        Send to user information about registration
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label" for="new_first_name">First name</label>
                                    <div class="controls">
                                        <input type="text" class="input-xlarge centered" id="new_first_name" placeholder="first name">
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label" for="new_last_name">Last name</label>
                                    <div class="controls">
                                        <input type="text" class="input-xlarge centered" id="new_last_name" placeholder="last name">
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label class="control-label" for="new_password"><b>Password*</b></label>
                                    <div class="controls">
                                        <input type="password" class="input-xlarge centered" id="new_password" placeholder="password">
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="controls">
                                        <input type="password" class="input-xlarge centered" id="new_password_repeat" placeholder="repeat password">
                                    </div>
                                </div>

                            </fieldset>
                        </form>
                    </div>

                    <div class="span4">
                        <div class="control-group">
                            <label class="control-label" for="groups_select">Select new user's group:</label>
                            <div class="controls">
                                <select multiple="multiple" style="height: 240px" id="groups_select">
                                </select>
                            </div>
                        </div>
                        <div class="control-group">
                            <label class="control-label" for="add_new_group_input">Or add new group:</label>
                            <div class="controls">
                                <input type="text" class="input-large centered" id="add_new_group_input" placeholder="new group name">
                            </div>
                        </div>

                    </div>
            </div>
        </div>
        <div class="modal-footer">
            <btn type="button" class="btn btn-success btn-large" onclick="add_user();"><i class="icon-plus-sign"></i> Add User</btn>
            <a href="#" class="btn btn-large" data-dismiss="modal" onclick="show_users_list();">Close</a>
        </div>
    </div>
    {% endif %}

    {% if 'group:admins' in user_groups or 'group:moderators' in user_groups %}
    <div id="descModal" class="modal hide fade" style="width: 670px">
        <!-- slightly non-centered - FIXME -->
        <div class="modal-header">
            <a class="close" data-dismiss="modal" >&times;</a>
            <h3>Image installation</h3>
        </div>
        <div class="modal-body">

        <div id="modal_content">


        </div>

        <hr>

        <div id="software">
            <!-- THIS BLOCK IS TODO:
                    SHOW OS ver,
            </div>


            <!--hr-->

            <form class="form-horizontal">
                <fieldset>

                    <div class="control-group span8">
                        <label class="control-label" for="in-name">Machine name</label>
                        <div class="controls">
                            <input id="in-name" type="text" class="input-xlarge" maxlength="30">
                        </div>
                    </div>


                </fieldset>
            </form>

            <p id="storage_info" align="center">
                <b>Available:</b> ??? <!-- add spaces here TODO -->
                <b>Required:</b> ???
            </p>


        </div>
        <div class="modal-footer">
            <btn type="button" class="btn btn-success btn-large" onclick="install_machine();"><i class="icon-pencil"></i> Install</btn>
            <a href="#" class="btn btn-large" data-dismiss="modal" >Close</a>
        </div>
    </div>
    {% endif %}






    </div><!--/.fluid-container-->



{% endblock %}

{% block ajp_scripts %}
    <!--
                                         _      __
                                        /_|   //__)_  _   _ _ _ _   _ _ _ ' _/ _
                                       (  |(_//   //)(//)(/(/(-/  _) ( / //)/_)
                                                          _/             /
                                                                                                         -->
    <script type="text/javascript" src="{{ request.static_url('ajpmanager:static/Scripts/navigation.js') }}"></script>
    <script type="text/javascript" src="{{ request.static_url('ajpmanager:static/Scripts/helpers.js') }}"></script>
    <script type="text/javascript" src="{{ request.static_url('ajpmanager:static/Scripts/modals.js') }}"></script>
    <script type="text/javascript" src="{{ request.static_url('ajpmanager:static/Scripts/querying.js') }}"></script>
    <script type="text/javascript" src="{{ request.static_url('ajpmanager:static/Scripts/query_processing.js') }}"></script>
    <script src="{{ request.static_url('ajpmanager:static/noVNC/vnc.js') }}"></script>
    <script src="{{ request.static_url('ajpmanager:static/noVNC/ui.js') }}"></script>
    <script type="text/javascript" src="{{ request.static_url('ajpmanager:static/Scripts/noVNC_ajp.js') }}"></script>
{% endblock %}




{% block ready_scripts %}
    $(document).ready (function() {
        show_default_screen(true);
        if (screen.width<1281) {
            $('#noVNC_screen').removeClass('well');
        }
    });
    {% if 'group:admins' in user_groups or 'group:moderators' in user_groups %}
    var $privileged = true;
    {% else %}
    var $privileged = false;
    {% endif %}
    var $self_username = '{{ username }}';
    {# Yes, this can be changed by user, but we don't mind, because we have server-side security
       so this `var` was made only for user's smooth experience. #}
{% endblock %}


{% block additional_scripts %}
    <!-- Chosen -->
    <script type="text/javascript" src="{{ request.static_url('ajpmanager:static/extras/chosen/chosen.jquery.min.js') }}"></script>
    <!-- Activate Chosen js -->
    <script type="text/javascript"> $(".chzn-select").chosen(); $(".chzn-select-deselect").chosen({allow_single_deselect:true}); </script>
{% endblock %}
</div>